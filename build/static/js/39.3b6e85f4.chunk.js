(this["webpackJsonp@coreui/coreui-pro-react-admin-template-starter"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template-starter"]||[]).push([[39],{916:function(e,t,a){"use strict";a.r(t);var r=a(27),n=a.n(r),c=a(50),s=a(191),i=a(6),o=a(187),l=a(188),d=a(190),j=a(189),u=a(619),h=a(571),p=a.n(h),b=(a(414),a(714),a(2)),m=a.n(b),g=a(608),O=a.n(g),f=a(185),x=a(592),v=(a(630),a(799)),_=a(800),y=a(801),M=a(710),w=a(711),N=a(785),k=a(887),C=a(786),S=a(621),T=a(628),P=a(899),D=a(911),L=a(900),I=a(901),E=a(848),F=a(902),G=a(610),A=a.n(G),J=a(59),z=a.n(J),U=a(8),H="https://api.aesoptips.com/api/",R=a(594),B=a(611),V=a(24),Z=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).onFieldChange=function(e){var t,a=r.state,n=a.page,c=a.type;"pageLength"===e.target.name&&r.props.getMediaDetails(n,e.target.value,c),r.setState((t={},Object(s.a)(t,e.target.name,e.target.value),Object(s.a)(t,"fields",Object(i.a)(Object(i.a)({},r.state.fields),{},Object(s.a)({},e.target.name,e.target.value))),t))},r.onMediaStatusChange=function(e){var t=e.flag;e.flag=1,1===t&&(e.flag=2);var a={flag:e.flag},n=e._id;r.props.changeMediaStatus(n,a).then((function(e){x.b.success(e.data.message)})).catch((function(e){A()("Error!","Error occurred, Please try again later!","error")}))},r.toggleMediaModal=function(e){r.setState(Object(i.a)(Object(i.a)({},r.state),{},{showModal:!1,fields:{_id:null,imageType:"",cover_photo:"",cover_photo_preview:"",image_name:""},errors:{error_image_name:"",error_imageType:"",error_cover_photo:""}}))},r.openModal=function(e){r.setState(Object(i.a)(Object(i.a)({},r.state),{},{showModal:!0,fields:{_id:null,imageType:"",cover_photo:"",cover_photo_preview:""},errors:{error_image_name:"",error_imageType:"",error_cover_photo:""}}))},r.onPhotoChange=function(){var e=Object(c.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!0,t.target.files&&t.target.files.length>0&&(a=t.target.files[0],!1,a?a.name.match(/\.(png|PNG|jpg|JPG|jpeg|JPEG|gif|GIF)$/)?(!0,r.setState(Object(i.a)(Object(i.a)({},r.state),{},{fields:Object(i.a)(Object(i.a)({},r.state.fields),{},{cover_photo:a,cover_photo_preview:URL.createObjectURL(a)}),errors:Object(i.a)(Object(i.a)({},r.state.errors),{},{error_cover_photo:""})}))):(!1,r.setState(Object(i.a)(Object(i.a)({},r.state),{},{fields:Object(i.a)(Object(i.a)({},r.state.fields),{},{cover_photo:""}),errors:Object(i.a)(Object(i.a)({},r.state.errors),{},{error_cover_photo:"Please select valid image."})}))):(!1,r.setState({errors:Object(i.a)(Object(i.a)({},r.state.errors),{},{error_cover_photo:"Please select image."})})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.onDeleteMedia=function(e){A()({title:"Are you sure?",text:"Are you sure that you want to delete ".concat(e.image_name,"?"),icon:"warning",buttons:!0,dangerMode:!0}).then((function(t){if(t){var a=r.state,n=a.page,c=a.pageLength,s=a.type;r.props.deleteMedia(e._id).then((function(e){r.props.getMediaDetails(n,c,s),x.b.success(e.data.message)})).catch((function(e){x.b.error(e.response.data.message)}))}}))},r.onSaveTour=function(e){e.preventDefault();var t,a,n,c=r.state.fields,s=c._id,i=c.imageType,o=c.image_name,l=c.cover_photo,d=r.state,j=d.errors,u=d.page,h=d.pageLength,p=d.type,b=!0;if(t=Object(R.b)(o,"Image Title "),n=Object(R.b)(l,"Image "),a=Object(R.b)(i,"Image Type "),t||n||a?(b=!1,r.setState({errors:{error_image_name:t,error_imageType:a,error_cover_photo:n}})):r.setState({errors:{error_image_name:"",error_imageType:"",error_cover_photo:""}}),b){r.setState({saveLoading:!0});var m=new FormData;if(m.append("image_name",o),m.append("type",i),m.append("image_path",l),null===s)r.props.addMedia(m).then((function(e){r.props.getMediaDetails(u,h,p).then((function(t){x.b.success(e.data.message),r.setState({saveLoading:!1,showModal:!1})}))})).catch((function(e){r.setState({saveLoading:!1,showModal:!1}),x.b.error(e.response.data.message),A()("Error!","Error occurred, Please try again later!","error")}));else{var g=s;r.props.updateMedia(g,m).then((function(e){r.props.getMediaDetails(u,h,p),x.b.success(e.data.message),r.setState({saveLoading:!1,showModal:!1})})).catch((function(e){x.b.error(e.response.data.message),r.setState({saveLoading:!1,showModal:!1})}))}r.setState({errors:j})}},r.onPageClick=function(e){var t=r.state.pageLength;r.props.getMediaDetails(e,t)},r.state={page:1,pageLength:10,showModal:!1,saveLoading:!1,type:"",fields:{_id:null,image_name:"",imageType:"",cover_photo:"",cover_photo_preview:""},errors:{error_image_name:"",error_imageType:"",error_cover_photo:""}},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.state,t=e.page,a=e.pageLength,r=e.type;this.props.getMediaDetails(t,a,r)}},{key:"onEditMediaModal",value:function(e){this.setState(Object(i.a)(Object(i.a)({},this.state),{},{showModal:!0,fields:{_id:e._id,image_name:e.image_name,imageType:e.type,cover_photo:e.image_path,cover_photo_preview:e.image_path}}))}},{key:"paginationSection",value:function(e){for(var t=this,a=e.page,r=e.totalPages,n=e.hasPrevPage,c=e.hasNextPage,s=e.prevPage,i=e.nextPage,o=[],l=0,d=1;d<=r;d++)1===d||a<4&&d<=5||d===a-1||d===a+1||d===a||d===r||a>=r-3&&d>=r-4?function(){var e=d,r=Object(V.jsxs)(m.a.Fragment,{children:[1===l?Object(V.jsx)(v.a,{children:Object(V.jsx)(_.a,{disabled:!0,tag:"button",children:"..."})}):null,Object(V.jsx)(v.a,{active:a===d,onClick:a===d?function(){return null}:function(){return t.onPageClick(e)},children:Object(V.jsx)(_.a,{tag:"button",children:d})},d)]},d);l=0,o.push(r)}():l=1;return Object(V.jsx)("nav",{children:Object(V.jsxs)(y.a,{children:[Object(V.jsx)(v.a,{onClick:!0===n?function(){return t.onPageClick(s)}:null,children:Object(V.jsx)(_.a,{previous:!0,disabled:!0!==n,tag:"button",children:"Prev"})}),o,Object(V.jsx)(v.a,{onClick:!0===c?function(){return t.onPageClick(i)}:null,children:Object(V.jsx)(_.a,{next:!0,tag:"button",disabled:!0!==c,children:"Next"})})]})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.showModal,r=t.saveLoading,n=t.errors,c=t.pageLength,s=this.state.fields,i=s.imageType,o=s.image_name,l=s.cover_photo_preview,d=this.props.mediaDetails,j=d.mediaDetails,h=d.mediaLoading,b=j.page;return b-=1,Object(V.jsxs)("div",{className:"animated fadeIn",children:[Object(V.jsx)(x.a,{position:"top-right",autoClose:3e3,style:{zIndex:1999}}),Object(V.jsx)(M.a,{children:Object(V.jsxs)(w.a,{xs:"12",children:[Object(V.jsxs)(N.a,{className:"card-style shadow",children:[Object(V.jsxs)(k.a,{children:[Object(V.jsx)("i",{className:"fa fa-picture-o"}),Object(V.jsx)("strong",{children:"Media Management"})]}),Object(V.jsxs)(C.a,{children:[Object(V.jsxs)(M.a,{children:[Object(V.jsx)(w.a,{md:"6",className:"pl-3",children:Object(V.jsxs)("div",{className:"text-left",children:[Object(V.jsx)("span",{className:"",children:"Show"}),Object(V.jsxs)("select",{type:"text",name:"pageLength",value:c,onChange:function(t){return e.onFieldChange(t)},className:"form-control list-width input  d-inline  mx-2",children:[Object(V.jsx)("option",{value:10,children:"10"}),Object(V.jsx)("option",{value:20,children:"20"}),Object(V.jsx)("option",{value:50,children:"50 "}),Object(V.jsx)("option",{value:100,children:"100 "})]}),Object(V.jsx)("span",{className:"",children:"Entries "})]})}),Object(V.jsx)(w.a,{md:"6",className:"mb-2",children:Object(V.jsx)("div",{className:"text-right",children:Object(V.jsx)(B.Tooltip,{title:"Add new media",position:"bottom",arrow:!0,distance:15,trigger:"mouseenter",children:Object(V.jsxs)(S.a,{size:"md",className:"btnColor btn-brand mr-1 ",onClick:this.openModal,children:[Object(V.jsx)("i",{className:"fa fa-plus"}),Object(V.jsx)("span",{children:"Add "})]})})})})]}),Object(V.jsxs)(T.a,{responsive:!0,striped:!0,className:"mt-2 customDataTable text-center",children:[Object(V.jsx)("thead",{children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"No."}),Object(V.jsx)("th",{children:"Image Name"}),Object(V.jsx)("th",{children:"Image Type"}),Object(V.jsx)("th",{className:"text-left",children:"Status"}),Object(V.jsx)("th",{children:"Action"})]})}),Object(V.jsx)("tbody",{children:!h&&j.docs.length>0?j.docs.map((function(t,a){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:b*c+(a+1)}),Object(V.jsx)("td",{children:t.image_name}),Object(V.jsx)("td",{children:1===t.type?"Home":2===t.type?"Favicon":""}),Object(V.jsx)("td",{children:Object(V.jsx)(u.l,{className:"d-block mt-1",variant:"3d",color:"primary",name:"status",checked:1===t.flag,label:!0,dataOn:"\u2715",dataOff:"\u2713",onClick:function(){return e.onMediaStatusChange(t)}})}),Object(V.jsxs)("td",{children:[Object(V.jsx)(B.Tooltip,{title:"Edit media",position:"bottom",arrow:!0,distance:15,trigger:"mouseenter",children:Object(V.jsx)(S.a,{size:"md",className:"btn-behance btn-brand ml-2",onClick:function(){return e.onEditMediaModal(t)},type:"button",children:Object(V.jsx)("i",{className:"fa fa-pencil"})})}),Object(V.jsx)(B.Tooltip,{position:"bottom",arrow:!0,distance:15,trigger:"mouseenter",title:"Delete media",children:Object(V.jsx)(S.a,{size:"md",className:"btn-youtube btn-brand ml-2",onClick:function(){return e.onDeleteMedia(t)},type:"button",children:Object(V.jsx)("i",{className:"fa fa-trash"})})})]})]},a)})):h?Object(V.jsx)("tr",{children:Object(V.jsx)("td",{colSpan:"6",className:"middle-align text-center",children:Object(V.jsx)(P.a,{type:"grow"})})}):0!==j.docs.length||h?null:Object(V.jsx)("tr",{children:Object(V.jsx)("td",{colSpan:"6",className:"middle-align text-center",children:"No Media found"})})}),Object(V.jsx)("tfoot",{children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"No."}),Object(V.jsx)("th",{children:"Image Name"}),Object(V.jsx)("th",{children:"Image Type"}),Object(V.jsx)("th",{className:"text-left",children:"Status"}),Object(V.jsx)("th",{children:"Action"})]})})]}),Object(V.jsx)("div",{className:"row float-right",children:Object(V.jsx)("div",{className:"col-md-12",children:this.paginationSection(j)})})]})]}),Object(V.jsxs)(D.a,{isOpen:a,size:"lg",children:[Object(V.jsx)(L.a,{toggle:this.toggleMediaModal,children:null!==this.state.fields._id?Object(V.jsx)("span",{children:"Edit Media Management"}):Object(V.jsx)("span",{children:"Add Media Management"})}),Object(V.jsxs)(I.a,{children:[Object(V.jsxs)(E.a,{row:!0,children:[Object(V.jsxs)(w.a,{xs:"6",children:[Object(V.jsx)("label",{children:"Image Name"}),Object(V.jsx)("input",{placeholder:"Enter Image Name",rows:"3",type:"text",name:"image_name",onChange:function(t){return e.onFieldChange(t)},defaultValue:o,className:p()("form-control",{"form-control input":!0})}),n.error_image_name.length>0?Object(V.jsx)("em",{className:"error invalid-feedback",children:n.error_image_name}):null]}),Object(V.jsxs)(w.a,{xs:"6",children:[Object(V.jsx)("label",{children:"Image Type"}),Object(V.jsxs)("select",{type:"text",name:"imageType",value:i,onChange:function(t){return e.onFieldChange(t)},className:p()("form-control",{"form-control input":!0}),children:[Object(V.jsx)("option",{value:"",children:"Select Type"}),Object(V.jsx)("option",{value:1,children:"Home"}),Object(V.jsx)("option",{value:2,children:"Favicon"})]}),n.error_imageType.length>0?Object(V.jsx)("em",{className:"error invalid-feedback",children:n.error_imageType}):null]})]}),Object(V.jsx)(E.a,{row:!0,children:Object(V.jsxs)(w.a,{xs:"6",children:[Object(V.jsx)("label",{children:"Image"}),Object(V.jsx)("input",{type:"file",name:"cover_photo",className:" file-input form-control",style:{height:"42px"},onChange:this.onPhotoChange}),Object(V.jsx)("div",{className:"file-info",children:Object(V.jsx)("em",{children:"(Note: Only JPEG, JPG, PNG, GIF image type allowed)"})}),""!==l&&Object(V.jsx)("img",{src:l,alt:"cover",className:"w-50"}),n.error_cover_photo.length>0?Object(V.jsx)("em",{className:"error invalid-feedback",children:n.error_cover_photo}):null]})})]}),Object(V.jsxs)(F.a,{className:"px-4",children:[Object(V.jsx)(O.a,{className:"btn btnColor btn-brand  btn-ladda",loading:r,"data-color":"blue","data-style":g.ZOOM_OUT,onClick:this.onSaveTour,children:"Save"}),Object(V.jsx)("button",{className:"btn btn-outline cancel",onClick:this.toggleMediaModal,children:Object(V.jsx)("span",{children:" Cancel"})})]})]})]})})]})}}]),a}(b.Component);t.default=Object(f.b)((function(e){return{mediaDetails:e.mediaDetails}}),{getMediaDetails:function(e,t,a){return function(){var r=Object(c.a)(n.a.mark((function r(c){var s;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,z.a.get(H+"media?page="+e+"&limit="+t+"type="+a);case 2:s=r.sent,c({type:U.k,payload:s.data.result});case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},changeMediaStatus:function(e,t){return function(){var a=Object(c.a)(n.a.mark((function a(r){var c;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,z.a.put(H+"media/change-status/"+e,t);case 2:return c=a.sent,a.abrupt("return",c);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},addMedia:function(e){return function(){var t=Object(c.a)(n.a.mark((function t(a){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z.a.post(H+"media",e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},updateMedia:function(e,t){return function(){var a=Object(c.a)(n.a.mark((function a(r){var c;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,z.a.put(H+"media/"+e,t);case 2:return c=a.sent,a.abrupt("return",c);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},getMediaDetailsById:function(e,t){return function(){var t=Object(c.a)(n.a.mark((function t(a){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z.a.patch(H+"media/"+e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},deleteMedia:function(e){return function(){var t=Object(c.a)(n.a.mark((function t(a){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z.a.delete(H+"media/"+e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})(Z)}}]);
//# sourceMappingURL=39.3b6e85f4.chunk.js.map